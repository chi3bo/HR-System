<div class="bg-white px-sm-5">
    <section class="w-100 container-fluid rounded-3 vh-80 py-5 p-sm-5 CardOne" [ngClass]="{'slideIn': pageOpenOne}">
        <h1 class="text-center py-5 fw-bolder {{ 'admin_vacation.حجم_الخط_إدارة_الطلبات' | translate }}">{{ 'admin-letters.ادارة_طلبات_الخطابات' | translate }}</h1>

        <!-- the table header -->
        <div class="{{ 'direction' | translate }}">
            <div class="ordersHead rounded-top-1 w-100 py-3">
                <div class="row">
                    <div class="col-md-3 text-center hide-on-mobile">
                        <p class="p-0 my-0">{{ 'admin-letters.اسم_الموظف' | translate }}</p>
                    </div>
                    <div class="col-md-3 text-center hide-on-mobile">
                        <p class="p-0 my-0">{{ 'admin-letters.رقم_الطلب' | translate }}</p>
                    </div>
                    <div class="col-md-3 text-center hide-on-mobile">
                        <p class="p-0 my-0 px-5">{{ 'admin-letters.نوع_الطلب' | translate }}</p>
                    </div>
                    <div class="col-md-3 text-center hide-on-mobile">
                        <p class="p-0 my-0">{{ 'admin-letters.نوع_الخطاب' | translate }}</p>
                    </div>
                    <div class="col-md-3 text-center miniHeader show-on-mobile-only">
                        <p class="p-0 my-0">{{ 'admin-letters.الطلبات_الخاصة_بالخطابات' | translate }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- the row of each employee -->
        <div class="accordion {{ 'direction' | translate }} overflow-hidden" id="accordionExample">

            <!-- one employee -->
            <div id="oneItem" #oneItem class="accordion-item rounded-0" *ngFor="let order of LettersList.reverse()">
                <h2 class="accordion-header">
                    <div class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        [attr.data-bs-target]="'#'+order.id" aria-expanded="false" [attr.aria-controls]="order.id">
                        <div class="py-2 px-0 d-flex w-100 row justify-content-center align-items-center">
                            <p class="my-0 col-md-3 fw-bolder w-50-mobile text-center">{{ order.employeeName }}</p>
                            <p class="my-0 col-md-3 fw-bolder w-50-mobile text-center">#{{ order.id }}</p>
                            <p class="my-0 col-md-3 fw-bolder text-center w-50-mobile hide-on-mobile">{{
                                'admin-letters.طلب_خطاب' | translate }}</p>
                            <p class="my-0 col-md-3 fw-bolder text-center w-50-mobile hide-on-mobile">
                                <span *ngIf="order.letterType == 'Identification'">{{ 'admin-letters.خطاب_تعريف' |
                                    translate
                                    }}</span>
                                <span *ngIf="order.letterType == 'Opened'">{{ 'admin-letters.خطاب_مفتوح' | translate
                                    }}</span>
                                <span *ngIf="order.letterType == 'External'">{{ 'admin-letters.خطاب_خارجي' | translate
                                    }}</span>
                                <span *ngIf="order.letterType == 'Delegation'">{{ 'admin-letters.خطاب_تفويض' | translate
                                    }}</span>
                            </p>
                        </div>
                    </div>
                </h2>
                <div [id]="order.id" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body p-0">
                        <div>
                            <p class="orderNumber my-0 d-inline-block bg-white px-2 mx-3 rounded">{{
                                'admin-letters.رقم_الطلب' | translate }}: {{ order.id }}</p>
                            <div
                                class="parentOfOrders mx-0 w-100 rounded border row d-flex justify-content-center align-items-center overflow-hidden">
                                <div class="col-md-4">
                                    <div class="w-100 {{'admin_vacation.border' | translate}} noBorder-mobile">
                                        <p class="my-0">{{ 'admin-letters.اسم_الموظف' | translate }}: <span
                                                class="my-0 small">{{ order.employeeName }}</span></p>
                                        <p class="my-0">{{ 'admin-letters.كود_الموظف' | translate }}: {{
                                            order.employeeId }}</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="w-100 {{'admin_vacation.border' | translate}} noBorder-mobile">
                                        <p class="my-0">{{ 'admin-letters.نوع_الخطاب' | translate }}:
                                            <span *ngIf="order.letterType == 'Identification'">{{
                                                'admin-letters.خطاب_تعريف' | translate }}</span>
                                            <span *ngIf="order.letterType == 'Opened'">{{ 'admin-letters.خطاب_مفتوح' |
                                                translate }}</span>
                                            <span *ngIf="order.letterType == 'External'">{{ 'admin-letters.خطاب_خارجي' |
                                                translate }}</span>
                                            <span *ngIf="order.letterType == 'Delegation'">{{ 'admin-letters.خطاب_تفويض'
                                                | translate }}</span>
                                        </p>
                                        <p class="my-0">{{ 'admin-letters.موجه_الي' | translate }}: {{
                                            order.destinationName }}</p>
                                        <p class="my-0">{{ 'admin-letters.يصدق_الغرفة_التجارية' | translate }}:
                                            <span *ngIf="order.isRequiredCCC == true">{{ 'general.نعم' | translate
                                                }}</span>
                                            <span *ngIf="order.isRequiredCCC == false">{{ 'general.لا' | translate
                                                }}</span>
                                        </p>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="w-100 noBorder-mobile">
                                        <p class="my-0" *ngIf="order.details">
                                            {{ 'admin-letters.تفاصيل_الخطاب' | translate }}:
                                            <span class="fw-light">
                                                {{ order.details }}
                                            </span>
                                        </p>

                                        <p class="my-0">
                                            {{ 'admin-letters.مرفقات' | translate }}:
                                            <span class="my-0" *ngIf="order.uploadFileId">
                                                <span (click)="fileDownload(order.uploadFileId)"
                                                    class="download-button text-primary cursor-pointer">
                                                    {{ 'admin-letters.تحميل_المرفق' | translate }}
                                                </span>
                                            </span>
                                            <span *ngIf="order.uploadFileId == null">{{ 'admin-letters.لا_يوجد' |
                                                translate }}</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="w-100 mx-auto p-1 text-center">
                                        <button (click)="actionRequest(order.id, true, detailsInput.value, oneItem)"
                                            class="btn btn-success my-1 w-100">{{ 'admin-letters.قبول' | translate
                                            }}</button>
                                        <button (click)="actionRequest(order.id, false, detailsInput.value, oneItem)"
                                            class="btn btn-danger my-1 w-100">{{ 'admin-letters.رفض' | translate
                                            }}</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="w-100 mx-auto pb-1 text-center">
                                        <input #detailsInput type="text" class="form-control border-dark"
                                            placeholder="{{ 'admin-letters.أضف_ملاحظاتك_هنا' | translate }}">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>